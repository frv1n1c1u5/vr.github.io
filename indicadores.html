<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indicadores Macroeconômicos | Vinicius Rocha</title>
    <meta name="description" content="Acompanhe em tempo real os principais indicadores macroeconômicos do Brasil: SELIC, IPCA, IGP-M, Dólar, Ibovespa e mais.">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
</head>
<body>

    <header class="sticky-header">
        <div class="container">
            <a href="index.html" class="logo">Vinicius Rocha</a>
            <nav>
                </nav>
        </div>
    </header>

    <main>
        <section class="content-page">
            <div class="container">
                <h2>Indicadores Macroeconômicos</h2>
                <p class="page-intro">Dados essenciais para entender o cenário econômico atual e tomar decisões de investimento mais informadas. Os valores são atualizados automaticamente.</p>
                
                <div class="indicators-page-grid" id="indicators-container">
                    <div class="indicator-card-large">
                        <h3>Inflação (IPCA)</h3>
                        <div class="indicator-item"><span>Acumulado no ano</span><strong id="ipca-ano">Carregando...</strong></div>
                        <div class="indicator-item"><span>Acumulado 12 meses</span><strong id="ipca-12m">Carregando...</strong></div>
                        <small>Fonte: IBGE / BCB</small>
                    </div>
                    <div class="indicator-card-large">
                        <h3>Taxa Selic</h3>
                        <div class="indicator-item"><span>Acumulada no ano</span><strong id="selic-ano">Carregando...</strong></div>
                        <div class="indicator-item"><span>Acumulada 12 meses</span><strong id="selic-12m">Carregando...</strong></div>
                        <small>Fonte: Banco Central</small>
                    </div>
                    <div class="indicator-card-large">
                        <h3>IGP-M</h3>
                        <div class="indicator-item"><span>Acumulado no ano</span><strong id="igpm-ano">Carregando...</strong></div>
                        <div class="indicator-item"><span>Acumulado 12 meses</span><strong id="igpm-12m">Carregando...</strong></div>
                        <small>Fonte: FGV / BCB</small>
                    </div>
                    <div class="indicator-card-large">
                        <h3>Dólar (PTAX Venda)</h3>
                        <div class="indicator-item"><span>Cotação Atual</span><strong id="dolar-atual">Carregando...</strong></div>
                        <div class="indicator-item"><span>Variação (Dia)</span><strong id="dolar-dia">Carregando...</strong></div>
                        <div class="indicator-item"><span>Mínima / Máxima (12M)</span><strong id="dolar-min-max-12m">Carregando...</strong></div>
                        <small>Fonte: BCB / Brapi</small>
                    </div>
                     <div class="indicator-card-large">
                        <h3>Ibovespa</h3>
                        <div class="indicator-item"><span>Pontuação</span><strong id="ibov-pontos">Carregando...</strong></div>
                        <div class="indicator-item"><span>Variação (Dia)</span><strong id="ibov-dia">Carregando...</strong></div>
                        <div class="indicator-item"><span>Variação no Ano</span><strong id="ibov-ano">Carregando...</strong></div>
                        <div class="indicator-item"><span>Variação 12 meses</span><strong id="ibov-12m">Carregando...</strong></div>
                        <small>Fonte: B3 / Brapi</small>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- FUNÇÕES AUXILIARES DE FORMATAÇÃO ---
            const formatPercent = (value) => value ? `${value.toFixed(2)}%` : 'N/A';
            const formatCurrency = (value) => value ? `R$ ${value.toFixed(2)}` : 'N/A';
            const formatPoints = (value) => value ? value.toLocaleString('pt-BR', { maximumFractionDigits: 2 }) : 'N/A';
            
            // Função para aplicar cor (verde/vermelho) a um valor
            const applyColor = (element, value) => {
                if (!value) return;
                element.classList.remove('positive', 'negative');
                if (value > 0) {
                    element.classList.add('positive');
                } else if (value < 0) {
                    element.classList.add('negative');
                }
            };

            // --- FUNÇÃO PRINCIPAL PARA CARREGAR DADOS ---
            async function loadIndicators() {
                try {
                    // Faz a chamada para a NOSSA API, não para a externa
                    const response = await fetch('/api/indicadores');
                    if (!response.ok) {
                        throw new Error('Não foi possível buscar os dados.');
                    }
                    const data = await response.json();

                    // Preenche os campos com os dados recebidos
                    // IPCA
                    document.getElementById('ipca-ano').textContent = formatPercent(data.ipca.ano);
                    document.getElementById('ipca-12m').textContent = formatPercent(data.ipca.doze_meses);
                    
                    // SELIC
                    document.getElementById('selic-ano').textContent = formatPercent(data.selic.ano);
                    document.getElementById('selic-12m').textContent = formatPercent(data.selic.doze_meses);

                    // IGP-M
                    document.getElementById('igpm-ano').textContent = formatPercent(data.igpm.ano);
                    document.getElementById('igpm-12m').textContent = formatPercent(data.igpm.doze_meses);

                    // Dólar
                    document.getElementById('dolar-atual').textContent = formatCurrency(data.dolar.cotacao);
                    const dolarDiaEl = document.getElementById('dolar-dia');
                    dolarDiaEl.textContent = formatPercent(data.dolar.variacao_dia);
                    applyColor(dolarDiaEl, data.dolar.variacao_dia);
                    document.getElementById('dolar-min-max-12m').textContent = data.dolar.min_max_12m || 'N/A';

                    // Ibovespa
                    document.getElementById('ibov-pontos').textContent = formatPoints(data.ibovespa.pontos);
                    const ibovDiaEl = document.getElementById('ibov-dia');
                    ibovDiaEl.textContent = formatPercent(data.ibovespa.variacao_dia);
                    applyColor(ibovDiaEl, data.ibovespa.variacao_dia);
                    document.getElementById('ibov-ano').textContent = formatPercent(data.ibovespa.variacao_ano);
                    document.getElementById('ibov-12m').textContent = formatPercent(data.ibovespa.variacao_12m);

                } catch (error) {
                    console.error('Erro ao carregar indicadores:', error);
                    // Coloca uma mensagem de erro em todos os campos
                    document.querySelectorAll('.indicators-page-grid strong').forEach(el => {
                        el.textContent = 'Erro';
                        el.classList.add('negative');
                    });
                }
            }

            // Inicia o carregamento dos dados
            loadIndicators();
        });
    </script>
</body>
</html>
